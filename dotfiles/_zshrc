TERMINAL=urxvt
HISTFILE=~/.histfile
HISTSIZE=10000
SAVEHIST=10000
setopt APPEND_HISTORY
setopt HIST_EXPIRE_DUPS_FIRST
setopt HIST_FCNTL_LOCK
setopt HIST_IGNORE_ALL_DUPS
setopt HIST_IGNORE_DUPS
setopt HIST_IGNORE_SPACE
setopt HIST_NO_STORE
setopt HIST_SAVE_NO_DUPS
setopt HIST_VERIFY
setopt INC_APPEND_HISTORY
setopt SHARE_HISTORY
setopt PROMPT_SUBST
bindkey -e
zstyle :compinstall filename $HOME/.zshrc

autoload -Uz add-zsh-hook
autoload -Uz compinit && compinit
autoload -Uz colors && colors
eval $(dircolors ~/.dircolors)

#ssh-agent magic
if ! pgrep -u $USER ssh-agent > /dev/null; then
    ssh-agent | sed -e '/echo/d' > ~/.ssh-agent-thing
fi
if [[ "$SSH_AGENT_PID" == "" ]]; then
    eval $(<~/.ssh-agent-thing)
fi

#Exported variables
export GOPATH=$HOME/Coding/golang
export EDITOR=vim
export LC_COLLATE=C #causes dotfiles to be sorted first

#Prompt configuration
print_timestamp() { date +"$fg[white][%T]$reset_color" }
add-zsh-hook preexec print_timestamp
git_prompt() { git branch 2>/dev/null | sed -e '/^* /!d' -e 's/^* //' }
PROMPT='\
╭─%{$fg[white]%}%n@%M %{$fg[green]%}%~/ $fg[red]$(git_prompt) %{$fg[white]%}$(date +"[%T]") %{$reset_color%}
╰─[%?]»'

#binary less
bless() {
  xxd -a $1 | less
}

#Off the record mode
otr() {
  zsh -is eval "unset HISTFILE; PROMPT='%~/ \$ '; echo '<OTR MODE>'"
}

shastr() {
  echo "$1" | sha256sum | cut -d ' ' -f1
}

#Aliases
alias ag='ag --pager "less -R" -S'
alias apt-get="sudo apt-get"
alias cp="cp -ri"
alias dup="( $TERMINAL & ) &>/dev/null"
alias g=git
alias gi=git
alias gdb="gdb --quiet"
alias gdbr="gdb --quiet --ex run --args"
alias ipt="sudo iptables"
alias j=jobs
alias ls="ls -hF  --color=auto"
alias ll="ls -lhF --color=auto"
alias la="ls -alhF --color=auto"
alias mv="mv -i"
alias pacman="sudo pacman --color auto"
alias rootme="sudo zsh -is eval 'source /home/harry/.zshrc'"
alias speedtest='wget -O /dev/null http://speedtest.wdc01.softlayer.com/downloads/test100.zip'
alias systemctl='sudo systemctl'
alias toclip="xclip -i -sel clipboard"
alias topri="xclip -i -sel primary"
alias fromclip="xclip -o -sel clipboard"
alias frompri="xclip -o -sel primary"
alias vol=alsamixer
alias feh="echo 'No. Bad habit. Use imv.'"
alias tmpdev='docker run --rm --volume /:/host --privileged -it ubuntu:14.04'

#Random order image viewing
rimv() {
  find $1 -type f | shuf | imv -
}

#Allow commands to override: zsh -is eval 'some commands here'
if [[ $1 == eval ]]
then
    "$@"
set --
fi
